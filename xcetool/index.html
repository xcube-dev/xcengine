
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://xcube-dev.github.io/xcengine/xcetool/">
      
      
        <link rel="prev" href="../notebook/">
      
      
        <link rel="next" href="../running-eoaps/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Running xcengine - xcengine</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-xcengine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="xcengine" class="md-header__button md-logo" aria-label="xcengine" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            xcengine
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Running xcengine
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="xcengine" class="md-nav__button md-logo" aria-label="xcengine" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    xcengine
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preparing your notebook
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Running xcengine
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Running xcengine
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-xcetool-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        The xcetool command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The xcetool command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xcetool-image-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        xcetool image build
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcetool-image-run" class="md-nav__link">
    <span class="md-ellipsis">
      
        xcetool image run
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcetool-make-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        xcetool make-script
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-your-container-image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Publishing your container image
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-eoaps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running Application Packages
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Further resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-xcetool-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        The xcetool command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The xcetool command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xcetool-image-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        xcetool image build
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcetool-image-run" class="md-nav__link">
    <span class="md-ellipsis">
      
        xcetool image run
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcetool-make-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        xcetool make-script
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-your-container-image" class="md-nav__link">
    <span class="md-ellipsis">
      
        Publishing your container image
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="running-xcengine">Running xcengine</h1>
<h2 id="the-xcetool-command">The <code>xcetool</code> command</h2>
<p>The command-line interface to xcengine is the command <code>xcetool</code>, which
implements multiple subcommands and options for building and running
container images and Application Packages.</p>
<p>You can use the <code>--help</code> flag for any <code>xcetool</code> command or subcommand to get more
details on usage and available options.</p>
<h3 id="xcetool-image-build"><code>xcetool image build</code></h3>
<p>Usage: <code>xcetool image build [OPTIONS] NOTEBOOK</code></p>
<p>This is the main <code>xcetool</code> subcommand: it builds a container image from a supplied
notebook and environment file. If given the <code>--eoap</code> argument, it also generates
a CWL file defining a corresponding application package.</p>
<p>Options:</p>
<ul>
<li><code>-b</code>, <code>--build-dir</code> <code>DIRECTORY</code>: Build directory to use for preparing the
    Docker image. If not specified, an automatically created temporary
    directory will be used.
    This option is mainly useful for debugging.</li>
<li><code>-e</code>, <code>--environment</code> <code>FILE</code>:
    Conda environment file to use in Docker image.
    If no environment file is specified here or in the notebook,
    xcetool will look for a file called <code>environment.yml</code>
    in the notebook's directory. If all else fails,
    xcetool will try to reproduce the current environment
    as a last resort, but this is not guaranteed to succeed.</li>
<li><code>-t</code>, <code>--tag</code> <code>TEXT</code>: Tag to apply to the Docker image.
    If not specified, a
    timestamp-based tag will be generated automatically.</li>
<li><code>-a</code>, <code>--eoap</code> <code>PATH</code>: Write a CWL file defining an Earth Observation
    Application Package to the specified path.</li>
<li><code>--help</code>: Show a help message for this subcommand and exit.</li>
</ul>
<h3 id="xcetool-image-run"><code>xcetool image run</code></h3>
<p>Usage: <code>xcetool image run [OPTIONS] IMAGE [CONTAINER_ARGUMENT]...</code></p>
<p>Options:</p>
<ul>
<li><code>-b</code>, <code>--batch</code>: Run the compute engine as a batch script.
    Use with the <code>--output</code> option to copy output
    out of the container.</li>
<li><code>-s</code>, <code>--server</code>: Run the compute engine as an xcube server.</li>
<li><code>-p</code>, <code>--port</code> INTEGER: Host port for xcube server (default: 8080).
    Implies <code>--server</code>.</li>
<li><code>-f</code>, <code>--from-saved</code>: If <code>--batch</code> and <code>--server</code> both used, serve
    datasets from saved Zarrs rather than
    computing them on the fly.</li>
<li><code>-o</code>, <code>--output</code> DIRECTORY  Write any output data to this directory,
    which will be created if it does not exist
    already.</li>
<li><code>-k</code>, <code>--keep</code>: Keep container after it has finished
    running.</li>
<li><code>-b</code>, <code>--open-browser</code>: After the server has started, open a web browser
    window showing the viewer. Implies <code>--server</code>.</li>
<li><code>--help</code>: Show a help message for this subcommand and exit.</li>
</ul>
<p>This subcommand runs an xcengine container image. Any arguments provided
after IMAGE will be passed on to the command executed inside the container.
An image can also be run using the <code>docker run</code> command, but
<code>xcetool image run</code> provides some additional convenience (e.g. easy
configuration of a server HTTP port).</p>
<p>If you use the <code>--server</code> option with <code>xcetool image run</code>, the image will be
run in xcube server mode: after the code from the input notebook is used to
generate datasets, those datasets will be made available in an xcube server
instance. You can also use the <code>--port</code> option to select the HTTP port where
the xcube server should be exposed. The server also includes an interactive
web viewer component. On start-up, <code>xcetool</code> will print the URLs of the xcube
server and viewer to the standard output.</p>
<p>If you give the <code>--server</code> or <code>--port</code> options, <code>xcetool</code> will run the
container indefinitely as an xcube server and viewer instance. You can stop
the container and force <code>xcetool</code> to exit by pressing ctrl-C on the command
line (or by sending it an interrupt signal in some other way).</p>
<h3 id="xcetool-make-script"><code>xcetool make-script</code></h3>
<p>This subcommand does not generate a container image, but a directory
containing the main contents that the image would have had: a script derived
from the notebook along with some supporting files. The <code>make-script</code>
subcommand is mainly useful for debugging.</p>
<p>Usage: <code>xcetool make-script [OPTIONS] NOTEBOOK OUTPUT_DIR</code></p>
<p>Create a compute engine script on the host system. The output directory will
be used for the generated script, supporting code modules, and any output
produced by running the script.</p>
<p>Options:</p>
<ul>
<li><code>-b</code>, <code>--batch</code>: Run as batch script after creating</li>
<li><code>-s</code>, <code>--server</code>: Run the script as an xcube server after creating it.</li>
<li><code>-f</code>, <code>--from-saved</code>: If <code>--batch</code> and <code>--server</code> both used, serve datasets from saved Zarrs rather than computing them on the fly.</li>
<li><code>-c</code>, <code>--clear</code>: Clear output directory before writing to it</li>
<li><code>--help</code>: Show a help message for this subcommand and exit.</li>
</ul>
<h2 id="publishing-your-container-image">Publishing your container image</h2>
<p>Once you have built your container image locally, you can push it to an online
registry. The tag is used to determine the registry and repository to which to
push the image. For example, if an image is tagged <code>quay.io/alice/helloworld:1.0</code>,
pushing it will attempt to upload the image to the repository <code>helloworld</code>
under the account <code>alice</code> on the registry <code>quay.io</code>. See the <a href="https://docs.docker.com/get-started/docker-concepts/the-basics/what-is-a-registry/">Docker
documentation</a>
for more details.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>